"""Tests for the MOM function."""
import taleb

import math

import numpy as np

from .data import create_dataset


def test_MOM():
    df = create_dataset()
    result = taleb.MOM(df["Close"].to_numpy())
    expected = np.array([
                math.nan,         math.nan,         math.nan,         math.nan,         math.nan,
               math.nan,         math.nan,         math.nan,         math.nan,         math.nan,
       -0.10117415, -0.0154313 ,  0.36561666, -0.16094793, -0.04645857,
        0.23286073,  0.45115444, -0.62617104, -0.31975299, -0.79033834,
       -0.08122413,  0.20647508, -0.69722991,  0.45296212,  0.70549975,
       -0.0125882 ,  0.27877346,  0.873261  ,  0.40136035,  0.20651335,
       -0.61954607, -0.14624855,  0.8513814 , -0.45859315, -0.70794227,
       -0.47706562, -0.40643771, -0.50391718, -0.29481258, -0.02971492,
       -0.00547684,  0.47143538, -0.5118516 , -0.06925706,  0.81708496,
        0.85490555, -0.33281669,  0.53052068,  0.52231814,  0.60074447,
       -0.04875005, -0.02934603,  0.29022157, -0.46459923, -0.55205676,
       -0.21742858,  0.80668047, -0.64967811, -0.63713165, -0.74846997,
        0.38259094, -0.74967068, -0.38742364,  0.81775737, -0.03663858,
        0.0624107 , -0.26214955, -0.25203131,  0.24153134,  0.75245573,
       -0.02181635,  0.88128028, -0.03482737, -0.37957393,  0.05340248,
       -0.04130964, -0.36254329,  0.20366562,  0.09884646, -0.76221455,
        0.02868971, -0.54895152, -0.10497317,  0.40694954, -0.34426875,
       -0.64565744,  0.31573819,  0.23822527,  0.18825148,  0.77580273,
       -0.17263677,  0.47410486,  0.07585656, -0.787846  ,  0.08114867,
        0.58048436,  0.12219726,  0.08384282, -0.46127743, -0.22372316
    ])
    np.testing.assert_almost_equal(expected, result)
